---
title: "Quiz Verification Table ds4owd-002"
format: html
---

Here you can find the results of [https://u4x6xe-lars-sch0bitz.shinyapps.io/ds4owd-002-quiz/](https://u4x6xe-lars-sch0bitz.shinyapps.io/ds4owd-002-quiz/), we will try to update the results every week before class.

```{r}
#| echo: false
#| message: false

library(DT)
library(gh)
library(readr)
library(base64enc)

# Read the quiz participation data
file_info <- gh("GET /repos/{owner}/{repo}/contents/{path}",
                owner = "ds4owd-dev",
                repo = "quiz-data",
                path = "data/quiz_participation.csv")

# Decode the base64 content properly
csv_content <- rawToChar(base64decode(file_info$content))

# Read the CSV from the decoded content
quiz_data <- read_csv(csv_content, show_col_types = FALSE)

# Display the data using DT
datatable(quiz_data,
          options = list(
            pageLength = 25,
            scrollX = TRUE
          ))
```

## A little data analysis

```{r}
#| echo: false
#| message: false

library(dplyr)
library(ggplot2)

# Calculate completion percentages by module
completion_stats <- quiz_data %>%
  group_by(Quiz) %>%
  summarise(
    Total_Students = n(),
    Completed = sum(Submitted == TRUE),
    Completion_Rate = round(Completed / Total_Students * 100, 1)
  )

ggplot(completion_stats, aes(x = Quiz, y = Completion_Rate)) +
  geom_col(fill = "steelblue", alpha = 0.7) +
  geom_text(aes(label = paste0(Completion_Rate, "%")),
            vjust = -0.5, size = 4) +
  labs(title = "Quiz Completion Rates by Module",
       x = "Module",
       y = "Completion Rate (%)") +
  theme_minimal() +
  ylim(0, max(completion_stats$Completion_Rate) * 1.1)
```